<div class="calendar"
  [style]="{
    'background-color': schedulerBackColor,
    'color': schedulerFontColor,
  }"
  [ngClass]="customClass">

  <app-calendar-header
    [weekStart]="weekStart"
    [weekEnd]="weekEnd"
    [year]="this.timeFrame.year"
    [monthName]="this.timeFrame.month"
    [titleColor]="titleColor"
    (onToday)="getToday()"
    (onWeekCHange)="getWeekChange($event)"
    (onGetFirstOrLastWeek)="getFirstOrLastWeek($event)"
    ></app-calendar-header>

  <div class="outer">

<div class="wrap">
  <table class="offset">
    <thead>
      <tr>
        <th class="headcol"></th>
        <th *ngFor="let dayInWeek of weekDays;"
          [ngClass]="{'is-today' : dayInWeek.date === today.split(' ')[0]}">
            {{ dayInWeek.day }}
        </th>
      </tr>
    </thead>
  <tbody>

    <tr *ngFor="let slot of timeSlots; even as isEven;" [attr.data-time]="slot">
      <td class="headcol">
        <span *ngIf="isEven" class="headcol-text">{{ slot }}</span>
      </td>
      <td *ngFor="let day of eventGrid"
        [ngClass]="{'is-today' : day.date === today}"
        (click)="findEvent(day, slot) ? openModal($event, null) : null;">

        <app-current-time-indicator
          *ngIf="day.date === today.split(' ')[0] && isCurrentTimeInSlot(slot)"
          [currentTime]="slot"
          [barColor]="currentTimeBarColor"
          ></app-current-time-indicator>

        <app-event
          *ngIf="findEvent(day, slot)?.event; else noEvent"
          (click)="openModal($event, findEvent(day, slot)?.event)"
          [eventSpan]="getEventSpan(day.date, slot) || null"
          [title]="findEvent(day, slot)?.event?.title || ''"
          [eventBackColor]="eventBackColor"
          [eventHoverColor]="eventHoverColor"
          [eventBorderColor]="eventBorderColor"
          [eventFontColor]="eventFontColor"
          [description]="findEvent(day, slot)?.event?.description || ''"
          >
        </app-event>

      </td>
    </tr>

  </tbody>
</table>
</div>
</div>
</div>

<ng-template #noEvent>
  <!-- Placeholder or empty cell -->
</ng-template>

<!-- ng-template for the modal form -->
<ng-template #eventForm let-event="event">

  <app-event-form></app-event-form>

</ng-template>

<app-modal #eventModal [title]="dialogTitle" [hideOnEsc]='true'>
  <ng-container *ngTemplateOutlet="eventForm; context: { event: currentEvent }"></ng-container>
</app-modal>
